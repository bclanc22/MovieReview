<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Recommendations</title>
    <style>
        /* Add your CSS styles here */
    </style>
</head>
<body>

    <label for="movieTitle">Enter Movie Title:</label>
    <input type="text" id="movieTitle">
    <button onclick="searchMovie()">Search</button>

    <ul id="recommendationList"></ul>

    <!-- Buttons for displaying specific recommendations -->
    <button onclick="displayRecommendation('shared_actors')">Recommendations Based on Shared Actors</button>
    <button onclick="displayRecommendation('genre')">Recommendations Based on Genre</button>
    <button onclick="displayRecommendation('director')">Recommendations Based on Director</button>

    <script>
        function searchMovie() {
            const searchQuery = document.getElementById('movieTitle').value;
            const xhr = new XMLHttpRequest();

            xhr.open('GET', `/search?searchQuery=${encodeURIComponent(searchQuery)}`, true);

            xhr.onload = function () {
                if (xhr.status >= 200 && xhr.status < 300) {
                    const searchResults = JSON.parse(xhr.responseText);
                    displaySearchResults(searchResults);
                } else {
                    console.error('Error fetching search results from the server');
                }
            };

            xhr.send();
        }

        function displaySearchResults(searchResults) {
            const recommendationList = document.getElementById('recommendationList');
            recommendationList.innerHTML = '';

            if (searchResults.length === 0) {
                const noResultsMessage = document.createElement('li');
                noResultsMessage.textContent = 'No matching movies found.';
                recommendationList.appendChild(noResultsMessage);
            } else {
                for (const movie of searchResults) {
                    const listItem = document.createElement('li');
                    listItem.textContent = `Title: ${movie['Movie Title']}`;
                    recommendationList.appendChild(listItem);
                }
            }
        }

        function displayRecommendation(type) {
            const movieTitle = document.getElementById('movieTitle').value;
            const xhr = new XMLHttpRequest();

            xhr.open('GET', `/recommendations?type=${type}&movieTitle=${encodeURIComponent(movieTitle)}`, true);

            xhr.onload = function () {
                if (xhr.status >= 200 && xhr.status < 300) {
                    const response = JSON.parse(xhr.responseText);
                    displayRecommendations(response);
                } else {
                    console.error('Error fetching data from the server');
                }
            };

            xhr.send();
        }

        function displayRecommendations(recommendations) {
            const recommendationList = document.getElementById('recommendationList');
            recommendationList.innerHTML = '';

            // Display details of the selected movie
            const details = recommendations.details;
            const detailsElement = document.createElement('li');
            detailsElement.textContent = `Details: ${JSON.stringify(details)}`;
            recommendationList.appendChild(detailsElement);

            // Display recommendations
            for (const key in recommendations) {
                if (key !== 'details' && recommendations[key]) {
                    const listItem = document.createElement('li');
                    listItem.textContent = `${key}: ${JSON.stringify(recommendations[key])}`;
                    recommendationList.appendChild(listItem);
                }
            }
        }
    </script>
</body>
</html>
